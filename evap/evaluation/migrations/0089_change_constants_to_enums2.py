# Generated by Django 2.0.8 on 2018-11-12 18:57

from django.db import migrations, models
import evap.evaluation.models


def change_to_integer(apps, _schema_editor):
    Contribution = apps.get_model('evaluation', 'Contribution')
    Contribution.objects.filter(textanswer_visibility='GENERAL').update(textanswer_visibility_integer=evap.evaluation.models.TextanswerVisibility(1))
    Contribution.objects.filter(textanswer_visibility='OWN').update(textanswer_visibility_integer=evap.evaluation.models.TextanswerVisibility(0))


def change_to_string(apps, _schema_editor):
    Contribution = apps.get_model('evaluation', 'Contribution')
    Contribution.objects.filter(textanswer_visibility_integer=evap.evaluation.models.TextanswerVisibility(1)).update(textanswer_visibility='GENERAL')
    Contribution.objects.filter(textanswer_visibility_integer=evap.evaluation.models.TextanswerVisibility(0)).update(textanswer_visibility='OWN')



class Migration(migrations.Migration):

    dependencies = [
        ('evaluation', '0088_change_constants_to_enums1'),
    ]

    operations = [
        migrations.RunPython(change_to_integer, reverse_code=change_to_string),
        migrations.RemoveField(
            model_name='contribution',
            name='textanswer_visibility',
        ),
        migrations.RenameField(
            model_name='contribution',
            old_name='textanswer_visibility_integer',
            new_name='textanswer_visibility'
        ),
    ]
